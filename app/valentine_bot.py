import os  # noqa: INP001

import aiofiles
from dotenv import load_dotenv
from telegram import InlineKeyboardButton, InlineKeyboardMarkup, Update, WebAppInfo
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    ContextTypes,
)

load_dotenv("../.env")

HELLO_IMG_PATH = "valentine_day/static/valentine_day/main.png"
API_KEY = os.environ["VALENTINE_BOT_API_KEY"]


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    _ = context
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    if update.message is None:
        return
    # URL –≤–∞—à–µ–≥–æ Mini App (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π)
    web_app_url: str = "https://atl-asana.vim-store.ru/valentine-day/"
    welcome_text_1: str = (
        "–£ —Ç–µ–±—è —Ç–æ–∂–µ —á—Ç–æ-—Ç–æ –≤–Ω–µ–∑–∞–ø–Ω–æ –∑–∞–∫–æ–ª–æ–ª–æ –≤ –æ–±–ª–∞—Å—Ç–∏ –≥—Ä—É–¥–∏ —Å–µ–≥–æ–¥–Ω—è? –û—Ç–º–µ–Ω–∞ –ø–∞–Ω–∏–∫–∏! "
        "–≠—Ç–æ –≤—Å–µ —à–∞–ª–æ—Å—Ç–∏ –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞, –≤–µ–¥—å —Å–µ–≥–æ–¥–Ω—è –æ–Ω —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ —Ä–∞—Å—á–µ—Ö–ª–∏–ª "
        "—Å–≤–æ–π –∫–æ–ª—á–∞–Ω –∏ –ø—Ä–æ–Ω–∑–∏–ª —Ç–≤–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ!üíò\n\n"
        "–ó–∞–ø–∏—Å—å –∫ –∫–∞—Ä–¥–∏–æ–ª–æ–≥—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–µ –æ—Ç–º–µ–Ω—è—Ç—å, —á–µ–∫–∞–ø ‚Äî —Ç–æ–∂–µ –≤–∞–∂–Ω–æ\n\n"
        "–î–∂–æ—ç–ª —Å—á–∏—Ç–∞–ª, —á—Ç–æ 14 —Ñ–µ–≤—Ä–∞–ª—è ‚Äî —ç—Ç–æ –ø—Ä–∞–∑–¥–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—É–º–∞–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏, "
        "–ø—Ä–æ–∏–∑–≤–æ–¥—è—â–∏–µ –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏, —á—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –ª—é–¥–µ–π —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –ø–∞—Ä—à–∏–≤–æ.\n\n"
        "–ú—ã –∂–µ —Å –Ω–∏–º –Ω–µ —Å–æ–≥–ª–∞—Å–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏—á–µ—Å–∫–∏, –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –¥–ª—è —Ç–µ–±—è —Å–∞–º—ã–µ –ª—É—á—à–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ "
        "–¥–ª—è —Ç–≤–æ–µ–≥–æ –¥—Ä—É–ª–ª–µ–≥–∏, –∞ –µ—â—ë ‚Äî —ç—Ç–æ—Ç –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ø—Ä–∏–∑–Ω–∞—Ç—å—Å—è –≤ —Ç–≤–æ–µ–π "
        "–ª—é–±–≤–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∞–Ω–æ–Ω–∏–º–Ω–æ, –±–µ–∑ –ø–æ–¥–ø–∏—Å–æ–∫, –∏ —Å–º—Å ü•π\n\n"
        "ü•∞ –ê–Ω–æ–Ω–∏–º–Ω–æ.\n"
        "‚òïÔ∏è –ë–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.\n"
        "üòä –ë–µ–∑ ¬´—ç—Ç–æ —è, –µ—Å–ª–∏ —á—Ç–æ¬ª, –Ω–æ –º–æ–∂–Ω–æ –∏ —Å –Ω–∏–º!\n\n"
        "–° –Ω–∞—Å ‚Äî –∫–∞—Ä—Ç–∏–Ω–∫–∞, —Å —Ç–µ–±—è ‚Äî —Ç–µ–∫—Å—Ç, –¥–∞–ª—å—à–µ –≤—Å—é –º–∞–≥–∏—é –ª—é–±–≤–∏ –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –±–æ—Ç üíå\n\n"
        "–ö—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª? –û–¥–∏–Ω –í–∞–ª–µ–Ω—Ç–∏–Ω –∑–Ω–∞–µ—Ç üôè\n"
        "–ö—Ç–æ –ø–æ–ª—É—á–∏—Ç? –í–æ–ø—Ä–æ—Å—ã —Ç–æ–∂–µ –∫ —Ç–æ–º—É –ø–∞—Ä–Ω—é —Å –Ω–∏–º–±–æ–º –∏ —Å—Ç—Ä–µ–ª–∞–º–∏!\n"
        "–ß—Ç–æ –¥–∞–ª—å—à–µ? –ü–æ–∫–∞–∂–µ—Ç ‚ú®–ª—é–±–æ–≤—å‚ú®\n\n"
        "–ó–∞—Ä—è–∂–∞–µ–º —Å—Ç—Ä–µ–ª—É?"
    )
    # –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    welcome_text_2: str = (
        "<b>–° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º, –∫–æ–ª–ª–µ–≥–∞! üíå</b>\n\n"
        "–í —ç—Ç–æ–º –≥–æ–¥—É –º—ã —Ä–µ—à–∏–ª–∏ –Ω–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—à –æ—Ñ–∏—Å —Ç–µ–ø–ª–æ–º –∏ –¥–æ–±—Ä—ã–º–∏ —Å–ª–æ–≤–∞–º–∏. "
        "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∫ <b>14 —Ñ–µ–≤—Ä–∞–ª—è</b> –º—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≥–¥–µ –º–æ–∂–Ω–æ "
        "–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É –ª—é–±–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É!\n\n"
        "<b>–ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å:</b>\n"
        "1Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–Ω–æ–ø–∫–∞ Open –∏–ª–∏ '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É')\n"
        "2Ô∏è‚É£ –í—ã–±–µ—Ä–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è\n"
        "3Ô∏è‚É£ –ü–æ–¥–±–µ—Ä–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –∏ –Ω–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç\n"
        "4Ô∏è‚É£ –ù–∞–∂–º–∏ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å¬ª\n\n"
        "ü§´ –í—Å–µ –ø–æ—Å–ª–∞–Ω–∏—è <b>–∞–Ω–æ–Ω–∏–º–Ω—ã</b>.\n"
        "‚è≥ –û—Ç–∫—Ä–æ–µ–º –ø–æ—á—Ç—É <b>13 —Ñ–µ–≤—Ä–∞–ª—è –≤ 14:00</b>."
    )

    # –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ Mini App
    keyboard = [[InlineKeyboardButton(text="üíå –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É", web_app=WebAppInfo(url=web_app_url))]]
    reply_markup = InlineKeyboardMarkup(keyboard)
    with aiofiles.open(HELLO_IMG_PATH, "rb") as photo_file:
        await update.message.reply_photo(
            photo=photo_file,
            caption=welcome_text_1,
            parse_mode="HTML",
        )
        await update.message.reply_text(
            text=welcome_text_2,
            parse_mode="HTML",
            reply_markup=reply_markup,
        )


if __name__ == "__main__":
    app = ApplicationBuilder().token(API_KEY).build()

    app.add_handler(CommandHandler("start", start))
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    app.run_polling()
